<!DOCTYPE html>
<html lang="ko" class="bg-slate-50">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>포항공대 CCC 대화 상자🤭</title>

  <!-- Pretendard -->
  <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.min.css" />
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Custom styles -->
  <link rel="stylesheet" href="./style.css" />

  <!-- 모달 백드롭 살짝 어둡게 -->
  <style>
    dialog::backdrop { background: rgba(2, 6, 23, .45); } /* slate-950/45 */
  </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-8">

  <!-- 헤더 -->
  <header class="w-full max-w-3xl mb-4 md:mb-6">
    <div class="flex items-start gap-3">
      <div class="flex-1">
        <h1 class="text-xl md:text-3xl font-semibold tracking-tight text-slate-900">
          포공 CCC 대화 상자🤭
        </h1>
        <p class="mt-1 text-sm md:text-base text-slate-600 leading-relaxed">
          <a href="http://bridge.cccvlm.com/" target="_blank" rel="noopener noreferrer"
             class="text-indigo-600 hover:text-indigo-700 underline underline-offset-2">
            CCC 브릿지 카드
          </a>에서 아이디어를 받아 제작한 대화 상자입니다.<br/>
          처음 보는 사람들끼리 사용할 때 풍성한 대화를 보낼 수 있습니다.<br />
        </p>
      </div>

      <!-- 더 알아보기 버튼 (모바일 우선, 아이콘형) -->
      <button id="helpBtn"
        class="shrink-0 ml-1 inline-flex items-center justify-center rounded-xl bg-white border border-slate-200 shadow-sm
               hover:bg-slate-100 active:bg-slate-200 focus-visible:outline-none focus-visible:ring-2
               focus-visible:ring-offset-2 focus-visible:ring-slate-400 w-10 h-10"
        type="button" aria-label="더 알아보기">
        <!-- 물음표 도형 아이콘 -->
        <svg viewBox="0 0 24 24" class="w-5 h-5 text-slate-700" fill="none" stroke="currentColor" stroke-width="1.8"
             stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M12 17h.01M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4" />
          <circle cx="12" cy="12" r="9" />
        </svg>
      </button>
    </div>
  </header>

  <!-- 상태바 -->
  <section class="w-full max-w-3xl mb-3 md:mb-4">
    <div class="flex items-center justify-between text-sm text-slate-600">
      <div id="counter" class="font-medium">0 / 0</div>
      <button id="resetBtn"
        class="px-3 py-2 rounded-lg text-slate-700 hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500"
        type="button" aria-label="다시 섞기">다시 섞기</button>
    </div>
    <div class="mt-2 h-2.5 w-full bg-slate-200 rounded-full overflow-hidden">
      <div id="progress" class="h-full bg-indigo-500 w-0"></div>
    </div>
  </section>

  <!-- 카드 스택 -->
  <main class="w-full max-w-3xl safe-bottom">
    <div id="stack" class="stack w-full aspect-[10/13] sm:aspect-[5/3] mb-4 md:mb-6">
      <!-- Top card -->
      <div id="cardTop" class="card instruction top select-none" role="button" tabindex="0" aria-label="카드">
        <div class="card-bg"></div>
        <div class="card-content max-w-2xl">
          <p id="topText" class="text-[22px] md:text-2xl leading-snug font-semibold tracking-[-0.01em]">
            화면을 눌러 대화를 시작하세요 👇
          </p>
        </div>
      </div>
      <!-- Back card (아래 대기) -->
      <div id="cardNext" class="card back hidden-card select-none" aria-hidden="true">
        <div class="card-bg" style="opacity:.06"></div>
        <div class="card-content max-w-2xl">
          <p id="nextText" class="text-[22px] md:text-2xl leading-snug font-semibold tracking-[-0.01em] text-slate-900"></p>
        </div>
      </div>
    </div>

    <!-- 하단 컨트롤 -->
    <div class="mt-3 md:mt-6 flex items-center gap-2 md:gap-3">
      <span class="text-sm text-slate-500">남은 카드 <span id="remaining">0</span>장</span>
      <button id="copyBtn"
        class="ml-auto min-h-[48px] rounded-xl bg-white hover:bg-slate-100 active:bg-slate-200
               text-slate-900 px-4 py-3.5 font-medium shadow-sm border border-slate-200
               focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-slate-400"
        type="button">질문 복사</button>
    </div>

    <p id="endMsg" class="mt-5 hidden text-center text-slate-600">
      모든 질문을 다 뽑았어요! <span class="font-medium">다시 섞기</span>를 눌러 새로 시작하세요.
    </p>
  </main>

  <!-- ===== 모달 (더 알아보기) ===== -->
  <dialog id="helpDialog" class="rounded-2xl p-0 w-[92vw] max-w-md">
    <div class="p-5 md:p-6">
      <div class="flex items-start gap-3">
        <h2 class="text-lg md:text-xl font-semibold text-slate-900">대화 상자 사용법</h2>
        <form method="dialog" class="ml-auto">
          <button aria-label="닫기"
            class="inline-flex items-center justify-center w-9 h-9 rounded-lg text-slate-600 hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500">
            ✕
          </button>
        </form>
      </div>
      <div class="mt-4 space-y-5 text-slate-700 text-sm md:text-base">
        <section>
          <h3 class="font-medium text-slate-900">둘이서 할 때</h3>
          <ul class="mt-2 list-disc list-inside space-y-1">
            <li>번갈아가며 카드를 넘기고 나온 질문에 답합니다.</li>
            <li>답변하기 민감한 질문은 때로는 넘기는 것도 좋답니다.</li>
          </ul>
        </section>

        <section>
          <h3 class="font-medium text-slate-900">여럿이서 할 때</h3>
          <ul class="mt-2 list-disc list-inside space-y-1">
            <li>원형으로 앉아 한 사람씩 카드를 넘기고 질문에 답합니다.</li>
            <li>자신의 질문에 답한 뒤, <span class="font-medium">듣고 싶은 사람에게 카드를 넘겨서</span> 답변을 듣습니다.</li>
            <li>서로의 이야기에 공감하거나 궁금한 점을 짧게 덧붙입니다.</li>
          </ul>
        </section>
      </div>

      <div class="mt-6 flex justify-end">
        <form method="dialog">
          <button
            class="rounded-xl bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-800 text-white px-4 py-2.5 font-medium shadow-md focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-indigo-500">
            확인
          </button>
        </form>
      </div>
    </div>
  </dialog>

  <!-- 데이터 → 앱 로직 → 모달 스크립트 -->
  <script defer src="./questions.js"></script>
  <script defer src="./script.js"></script>

  <!-- 모달 열기 전용 스크립트 (아주 짧게) -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const helpBtn = document.getElementById('helpBtn');
      const helpDialog = document.getElementById('helpDialog');
      if (helpBtn && helpDialog && helpDialog.showModal) {
        helpBtn.addEventListener('click', () => helpDialog.showModal());
        // 배경 클릭 닫기
        helpDialog.addEventListener('click', (e) => {
          const dialogRect = helpDialog.getBoundingClientRect();
          const inDialog = (
            e.clientX >= dialogRect.left && e.clientX <= dialogRect.right &&
            e.clientY >= dialogRect.top && e.clientY <= dialogRect.bottom
          );
          if (!inDialog) helpDialog.close();
        });
      }
    });
  </script>
</body>
</html>
